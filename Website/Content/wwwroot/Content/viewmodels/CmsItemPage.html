<link rel="import" href="/sys/juicy-ace-editor/juicy-ace-editor.html" />

<template>
    <template is="dom-bind">
        <h2>Content item</h2>
        <form class="form-horizontal">
            <template is="dom-if" if="{{model.Message$}}">
                <div class="alert alert-warning alert-dismissible">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close" value="{{model.Message$::click}}" onclick="this.value = '';">&times;</button>
                    <span>{{model.Message$}}</span>
                </div>
            </template>
            <div class="form-group">
                <label class="col-xs-2 control-label">Key:</label>
                <div class="col-xs-9">
                    <input type="text" class="form-control" value="{{model.Key}}" readonly />
                </div>
            </div>
            <div class="form-group">
                <label class="col-xs-2 control-label">Url:</label>
                <div class="col-xs-9">
                    <input type="text" class="form-control" value="{{model.Url}}" readonly />
                </div>
            </div>
            <div class="form-group">
                <label class="col-xs-2 control-label">File path:</label>
                <div class="col-xs-9">
                    <input type="text" class="form-control" value="{{model.HtmlPath}}" readonly />
                </div>
            </div>
            <div class="form-group">
                <label class="col-xs-2 control-label"></label>
                <div class="col-xs-9">
                    <!--<textarea class="form-control" rows="15" value="{{model.HtmlValue$::change}}"></textarea>-->
                    <juicy-ace-editor style="height: 400px; display:block;" mode="ace/mode/html" theme="ace/theme/monokai">{{model.HtmlValue$}}</juicy-ace-editor>
                </div>
            </div>
            <div class="form-group">
                <label class="col-xs-2 control-label"></label>
                <div class="col-xs-9">
                    <button type="button" class="btn btn-primary btn-sm" value="{{model.SaveClick$::click}}" onclick="++this.value;" on-mousedown="updateHtmlValue">Save change</button>
                    <a href="/content/cms" class="btn btn-default btn-sm">Go back</a>
                </div>
            </div>
        </form>
        <dom-bind-notifier path="model" observed-object="{{model}}" deep></dom-bind-notifier>
    </template>
    <script>
        (function (template) {
            template.updateHtmlValue = function () {
                var editor = template.parentNode.querySelector("juicy-ace-editor").editor;
                var value = editor.getValue();

                template.set("model.HtmlValue$", value);
            };
        })(document.currentScript.previousElementSibling);
    </script>
</template>