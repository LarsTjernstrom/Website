<dom-module id="website-section">
    <style></style>
    <template>
        <template is="dom-repeat" items="{{applications}}">
            <puppet-import model="{{getValue(item)}}" path="{{getPath(item)}}" html="{{getHtml(item)}}"></puppet-import>
        </template>
    </template>
    <script>
        Polymer({
            is: "website-section",
            ready: function () {
            },
            getHtml: function (name) {
                return this.model[name].Html;
            },
            getValue: function (name) {
                if (this.model[name].Value) {
                    return this.model[name].Value;
                } else {
                    return this.model[name];
                }
            },
            getPath: function (name) {
                if (this.model[name].Value) {
                    return this.path + "." + name + ".Value";
                } else {
                    return this.path + "." + name;
                }
            },
            properties: {
                applications: {
                    type: Array,
                    value: [],
                    notify: true
                },
                model: {
                    type: Object,
                    value: null,
                    observer: "modelChanged"
                },
                path: {
                    type: String,
                    value: ""
                },
                pathName: {
                    type: String,
                    value: ""
                },
                pathIndex: {
                    type: String,
                    value: ""
                }
            },
            modelChanged: function (newValue, oldValue) {
                var apps = [];

                for (var i in newValue) {
                    if (newValue.hasOwnProperty(i) && newValue[i]) {
                        apps.push(i);
                    }
                }

                this.set("applications", []);

                setTimeout(function () {
                    this.set("applications", apps);
                }.bind(this));
            },
            pathNameChanged: function (newValue, oldValue) {
                this.path = newValue + "." + this.pathIndex;
            },
            pathIndexChanged: function (newValue, oldValue) {
                this.path = this.pathName + "." + newValue;
            }
        });
    </script>
</dom-module>